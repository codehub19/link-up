import{r as t,j as e,f as W,c as D,d as c,s as Q,m as r,k as T,Q as E}from"./index-D1459Nzo.js";import{A as L}from"./AdminGuard-p0RkhqR3.js";import{A as M}from"./AdminHeader-P52REjaF.js";function z(){const[o,w]=t.useState([]),[n,d]=t.useState(""),[u,m]=t.useState(49),[p,h]=t.useState(1),[x,f]=t.useState(""),[v,g]=t.useState(!1),[j,y]=t.useState(!0),[b,N]=t.useState(!1);async function l(){const a=await W(D(c,"plans"));w(a.docs.map(s=>({id:s.id,...s.data()})))}t.useEffect(()=>{l()},[]);function k(a){return a.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"")}async function S(a){if(a.preventDefault(),!!n.trim()){N(!0);try{const s=k(n),i=x.split(`
`).map(P=>P.trim()).filter(Boolean);await Q(r(c,"plans",s),{name:n,price:u,matchQuota:p,offers:i,supportAvailable:v,active:j,createdAt:new Date,updatedAt:new Date},{merge:!0}),d(""),f(""),m(49),h(1),g(!1),y(!0),await l()}finally{N(!1)}}}async function A(a){await T(r(c,"plans",a.id),{active:!a.active,updatedAt:new Date}),await l()}async function C(a){window.confirm(`Remove plan "${a.name}"? This does not affect existing subscriptions but users won't see this plan anymore.`)&&(await E(r(c,"plans",a.id)),await l())}return e.jsx(L,{children:e.jsx("div",{className:"container",children:e.jsxs("div",{className:"card",style:{padding:24,margin:"24px auto",maxWidth:900},children:[e.jsx(M,{current:"plans"}),e.jsx("h2",{children:"Plans"}),e.jsxs("form",{className:"stack",onSubmit:S,style:{gap:10,marginTop:12},children:[e.jsxs("div",{className:"row",style:{gap:12,width:"100%",flexWrap:"wrap"},children:[e.jsxs("div",{className:"stack",style:{minWidth:220,flex:1},children:[e.jsx("label",{style:{fontWeight:600},children:"Plan name"}),e.jsx("input",{className:"input",placeholder:"e.g., Starter",value:n,onChange:a=>d(a.target.value)})]}),e.jsxs("div",{className:"stack",style:{minWidth:160},children:[e.jsx("label",{style:{fontWeight:600},children:"Price (₹)"}),e.jsx("input",{className:"input",type:"number",placeholder:"Price",value:u,onChange:a=>m(Number(a.target.value||0))})]}),e.jsxs("div",{className:"stack",style:{minWidth:160},children:[e.jsx("label",{style:{fontWeight:600},children:"Match quota"}),e.jsx("input",{className:"input",type:"number",placeholder:"Match quota",value:p,onChange:a=>h(Number(a.target.value||0))})]})]}),e.jsxs("div",{className:"stack",children:[e.jsx("label",{style:{fontWeight:600},children:"Offers"}),e.jsx("textarea",{className:"input",placeholder:"One offer per line",rows:4,value:x,onChange:a=>f(a.target.value)})]}),e.jsxs("div",{className:"row",style:{gap:12},children:[e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:v,onChange:a=>g(a.target.checked)})," Support available"]}),e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:j,onChange:a=>y(a.target.checked)})," Active"]})]}),e.jsx("div",{children:e.jsx("button",{className:"btn btn-primary",type:"submit",disabled:b,children:b?"Saving…":"Create/Update Plan"})})]}),e.jsxs("div",{className:"stack",style:{marginTop:24},children:[o.map(a=>{var s;return e.jsx("div",{className:"card",style:{padding:12},children:e.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center",gap:8,flexWrap:"wrap"},children:[e.jsxs("div",{children:[e.jsx("b",{children:a.name})," ",a.active?e.jsx("span",{style:{color:"#22c55e",marginLeft:6},children:"(Active)"}):e.jsx("span",{style:{color:"#ef4444",marginLeft:6},children:"(Inactive)"}),e.jsxs("div",{style:{color:"var(--muted)",fontSize:13},children:["₹",a.price," • Quota: ",a.matchQuota," • ",a.supportAvailable?"Support included":"No support"]}),(s=a.offers)!=null&&s.length?e.jsx("ul",{style:{margin:"6px 0 0 18px"},children:a.offers.map(i=>e.jsx("li",{children:i},i))}):null]}),e.jsxs("div",{className:"row",style:{gap:8},children:[e.jsx("button",{className:"btn",onClick:()=>A(a),children:a.active?"Deactivate":"Activate"}),e.jsx("button",{className:"btn btn-ghost",onClick:()=>C(a),children:"Remove"})]})]})},a.id)}),o.length===0?e.jsx("div",{className:"muted",children:"No plans created yet."}):null]})]})})})}export{z as default};
