import{u as x,r as m,j as e,N as v,L as y,F as N,b as d,t as I,v as w,x as U,y as k,m as F,d as A,s as S}from"./index-D1459Nzo.js";function E(){const{user:l,profile:s}=x(),[t,o]=m.useState({name:"",instagramId:"",bio:"",interests:"",photoUrl:void 0}),[g,u]=m.useState(null),[h,b]=m.useState(!1);m.useEffect(()=>{s&&o({name:s.name??"",instagramId:s.instagramId??"",bio:s.bio??"",interests:Array.isArray(s.interests)?s.interests.join(", "):s.interests??"",photoUrl:s.photoUrl})},[s]);const c=n=>{const{name:a,value:i}=n.target;o(p=>({...p,[a]:i}))},f=n=>u(n),j=async n=>{if(n.preventDefault(),!l){d.error("You must be signed in.");return}if(!t.name.trim()){d.error("Please enter your name.");return}b(!0);try{let a=t.photoUrl;if(g){const r=I(w,`users/${l.uid}/profile.jpg`);await U(r,g),a=await k(r)}const i=t.interests.split(",").map(r=>r.trim()).filter(Boolean),p=F(A,"users",l.uid);await S(p,{uid:l.uid,gender:(s==null?void 0:s.gender)??"female",name:t.name.trim(),instagramId:t.instagramId.trim(),bio:t.bio.trim(),interests:i,photoUrl:a,updatedAt:new Date},{merge:!0}),d.success("Profile updated"),u(null),o(r=>({...r,photoUrl:a}))}catch(a){const i=a instanceof Error?a.message:"Failed to update";d.error(i)}finally{b(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(v,{}),e.jsxs("div",{className:"container narrow",children:[e.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("h2",{style:{margin:0},children:"Edit Profile"}),e.jsx(y,{className:"btn ghost",to:"/dashboard/connections",children:"Back"})]}),e.jsx("form",{className:"form",onSubmit:j,children:e.jsxs("div",{className:"stack",style:{gap:12},children:[e.jsxs("div",{className:"stack",children:[e.jsx("label",{style:{fontWeight:600},children:"Photo"}),e.jsx(N,{onFile:f,previewUrl:t.photoUrl})]}),e.jsxs("div",{className:"stack",children:[e.jsx("label",{style:{fontWeight:600},children:"Full Name"}),e.jsx("input",{className:"input",name:"name",placeholder:"Your name",value:t.name,onChange:c})]}),e.jsxs("div",{className:"stack",children:[e.jsx("label",{style:{fontWeight:600},children:"Instagram ID"}),e.jsx("input",{className:"input",name:"instagramId",placeholder:"e.g., @username",value:t.instagramId,onChange:c})]}),e.jsxs("div",{className:"stack",children:[e.jsx("label",{style:{fontWeight:600},children:"Bio"}),e.jsx("textarea",{className:"input",name:"bio",rows:4,placeholder:"A short bio",value:t.bio,onChange:c})]}),e.jsxs("div",{className:"stack",children:[e.jsx("label",{style:{fontWeight:600},children:"Interests (comma-separated)"}),e.jsx("input",{className:"input",name:"interests",placeholder:"music, sports, travel",value:t.interests,onChange:c})]}),e.jsxs("div",{className:"row",style:{gap:8},children:[e.jsx("button",{className:"btn btn-primary",type:"submit",disabled:h,children:h?"Savingâ€¦":"Save Changes"}),e.jsx("button",{className:"btn ghost",type:"button",onClick:()=>{s&&(o({name:s.name??"",instagramId:s.instagramId??"",bio:s.bio??"",interests:Array.isArray(s.interests)?s.interests.join(", "):s.interests??"",photoUrl:s.photoUrl}),u(null))},disabled:h,children:"Reset"})]})]})})]})]})}export{E as default};
