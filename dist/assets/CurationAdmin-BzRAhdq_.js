import{q as R,w as F,c as G,d as u,f as T,r as a,p as $,H as j,m as f,j as e,J as q}from"./index-D1459Nzo.js";import{A as E}from"./AdminGuard-p0RkhqR3.js";import{g as B,l as H,s as P}from"./assignments-DGbKwRgw.js";import{A as D}from"./AdminHeader-P52REjaF.js";async function z(){const n=R(G(u,"users"),F("gender","==","female"));return(await T(n)).docs.map(c=>({uid:c.id,...c.data()}))}function X(){const[n,v]=a.useState(null),[c,A]=a.useState([]),[h,C]=a.useState(""),[t,U]=a.useState(null),[y,I]=a.useState([]),[m,g]=a.useState([]),[J,w]=a.useState([]),[b,N]=a.useState([]),l=n==null?void 0:n.id;a.useEffect(()=>{(async()=>{var r;const s=await $();if(v(s),s){const d=((r=(await j(f(u,"matchingRounds",s.id))).data())==null?void 0:r.participatingMales)||[],o=[];for(const k of d){const S=await j(f(u,"users",k));S.exists()&&o.push({uid:k,...S.data()})}I(o)}const i=await z();A(i)})()},[]),a.useEffect(()=>{(async()=>{if(!l||!t){g([]),w([]),N([]);return}const s=await B(l,t.uid);g(s.maleCandidates||[]);const i=await H(l,t.uid);w(i);const r=Array.from(new Set((i||[]).map(d=>d.likedUserUid))),p=[];for(const d of r){const o=await j(f(u,"users",d));o.exists()&&p.push({uid:d,...o.data()})}N(p)})()},[l,t]);async function W(){!l||!t||(await P(l,t.uid,m),alert("Assignments saved"))}async function M(s){!l||!t||(await q({roundId:l,boyUid:s,girlUid:t.uid}),alert("Match created"))}const x=a.useMemo(()=>new Set(m),[m]),L=a.useMemo(()=>c.filter(s=>(s.name||"").toLowerCase().includes(h.toLowerCase())||(s.instagramId||"").toLowerCase().includes(h.toLowerCase())),[c,h]);return e.jsx(E,{children:e.jsx("div",{className:"container",children:e.jsxs("div",{className:"card",style:{padding:24,margin:"24px auto",maxWidth:1300},children:[e.jsx(D,{current:"curation"}),e.jsx("h2",{style:{marginTop:0},children:"Round Curation"}),n?e.jsxs("p",{style:{color:"var(--muted)"},children:["Active round: ",e.jsx("b",{children:l})]}):e.jsx("p",{children:"No active round"}),e.jsxs("div",{className:"row",style:{gap:16,alignItems:"flex-start",flexWrap:"wrap"},children:[e.jsxs("div",{className:"card",style:{padding:16,width:340,maxHeight:560,overflow:"auto"},children:[e.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[e.jsx("b",{children:"Girls"}),e.jsx("input",{className:"input",placeholder:"Search by name or insta",style:{maxWidth:180},value:h,onChange:s=>C(s.target.value)})]}),e.jsx("div",{className:"stack",children:L.map(s=>e.jsx("button",{className:`btn ${(t==null?void 0:t.uid)===s.uid?"btn-primary":"btn-ghost"}`,onClick:()=>U(i=>(i==null?void 0:i.uid)===s.uid?null:s),style:{justifyContent:"flex-start"},children:e.jsxs("div",{className:"row",style:{gap:10,alignItems:"center"},children:[e.jsx("div",{className:"avatar",style:{width:28,height:28,borderRadius:999,overflow:"hidden",background:"#f3f3f3"},children:s.photoUrl?e.jsx("img",{src:s.photoUrl,style:{width:"100%",height:"100%",objectFit:"cover"}}):null}),e.jsxs("div",{children:[e.jsx("div",{children:s.name||s.uid}),e.jsxs("small",{style:{color:"var(--muted)"},children:["@",s.instagramId]})]})]})},s.uid))})]}),e.jsx("div",{className:"card",style:{padding:16,flex:1,minWidth:420},children:t?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{className:"row",style:{gap:12,alignItems:"center"},children:[e.jsx("div",{className:"avatar",style:{width:56,height:56,borderRadius:999,overflow:"hidden",background:"#f3f3f3"},children:t.photoUrl?e.jsx("img",{src:t.photoUrl,style:{width:"100%",height:"100%",objectFit:"cover"}}):null}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:700},children:t.name||t.uid}),e.jsxs("div",{style:{color:"var(--muted)"},children:["@",t.instagramId," ",t.college?`• ${t.college}`:""]})]})]}),e.jsx("button",{className:"btn btn-primary",onClick:W,children:"Save assignments"})]}),e.jsxs("div",{className:"row",style:{gap:16,flexWrap:"wrap",marginTop:12},children:[e.jsxs("div",{className:"card",style:{padding:12,flex:1,minWidth:320},children:[e.jsx("b",{children:"Approved males (toggle to assign)"}),e.jsxs("div",{className:"grid cols-2",style:{gap:8,marginTop:8},children:[y.map(s=>e.jsx("div",{className:`card ${x.has(s.uid)?"selected":""}`,style:{padding:10},children:e.jsxs("div",{className:"row",style:{gap:10},children:[e.jsx("div",{className:"avatar",style:{width:44,height:44,borderRadius:8,overflow:"hidden",background:"#f3f3f3"},children:s.photoUrl?e.jsx("img",{src:s.photoUrl,style:{width:"100%",height:"100%",objectFit:"cover"}}):null}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:600},children:s.name||s.uid}),e.jsxs("small",{style:{color:"var(--muted)"},children:["@",s.instagramId,s.college?` • ${s.college}`:""]}),s.bio?e.jsx("div",{style:{fontSize:12,marginTop:6,color:"var(--muted)"},children:s.bio}):null,e.jsx("div",{className:"row",style:{gap:6,flexWrap:"wrap",marginTop:6},children:(s.interests??[]).slice(0,4).map(i=>e.jsx("span",{className:"tag",children:i},i))})]}),e.jsx("div",{children:e.jsx("input",{type:"checkbox",checked:x.has(s.uid),onChange:()=>{g(i=>x.has(s.uid)?i.filter(r=>r!==s.uid):[...i,s.uid])}})})]})},s.uid)),y.length===0?e.jsx("div",{style:{color:"var(--muted)"},children:"No approved males yet."}):null]})]}),e.jsxs("div",{className:"card",style:{padding:12,flex:1,minWidth:320},children:[e.jsx("b",{children:"Girl’s likes (this round)"}),e.jsxs("div",{className:"grid cols-2",style:{gap:8,marginTop:8},children:[b.map(s=>e.jsx("div",{className:"card",style:{padding:10},children:e.jsxs("div",{className:"row",style:{gap:10},children:[e.jsx("div",{className:"avatar",style:{width:44,height:44,borderRadius:8,overflow:"hidden",background:"#f3f3f3"},children:s.photoUrl?e.jsx("img",{src:s.photoUrl,style:{width:"100%",height:"100%",objectFit:"cover"}}):null}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:600},children:s.name||s.uid}),e.jsxs("small",{style:{color:"var(--muted)"},children:["@",s.instagramId,s.college?` • ${s.college}`:""]})]}),e.jsx("div",{children:e.jsx("button",{className:"btn btn-primary",onClick:()=>M(s.uid),children:"Promote"})})]})},s.uid)),b.length===0?e.jsx("div",{style:{color:"var(--muted)"},children:"No likes yet."}):null]})]})]})]}):e.jsx("p",{children:"Select a girl to curate"})})]})]})})})}export{X as default};
