import{u as y,r as a,j as s,N as g,L as x,p as w,f as N,q as b,w as v,c as L,d as p,s as C,m as S,b as j}from"./index-D1459Nzo.js";import{C as U,P as E}from"./Carousel-DHp3MLYH.js";import{g as I,l as M}from"./assignments-DGbKwRgw.js";function D(){const{user:i}=y(),[n,l]=a.useState(null),[d,u]=a.useState([]),[h,f]=a.useState([]),[o,m]=a.useState(new Set);a.useEffect(()=>{(async()=>{const t=await w();if(!t){l(null);return}l(t.id||t.roundId)})()},[]),a.useEffect(()=>{(async()=>{if(!n||!i){u([]);return}const t=await I(n,i.uid);u(t.maleCandidates||[])})()},[n,i]),a.useEffect(()=>{(async()=>{if(d.length===0){f([]);return}const t=[];for(const r of d){const c=await N(b(L(p,"users"),v("uid","==",r)));c.empty||t.push(c.docs[0].data())}f(t)})()},[d]),a.useEffect(()=>{(async()=>{if(!i||!n)return;const t=await M(n,i.uid),r=new Set(t.map(c=>c.likedUserUid));m(r)})()},[i,n]);const k=async e=>{if(!(!i||!n)&&!o.has(e))try{const t=`${n}_${i.uid}_${e}`;await C(S(p,"likes",t),{roundId:n,likingUserUid:i.uid,likedUserUid:e,timestamp:new Date});const r=new Set(o);r.add(e),m(r),j.success("Liked!")}catch(t){j.error(t.message??"Failed to like")}};return n===null?s.jsxs(s.Fragment,{children:[s.jsx(g,{}),s.jsxs("div",{className:"container",children:[s.jsx("h2",{children:"The next round is coming soon!"}),s.jsx("p",{className:"muted",children:"We’ll notify you when it’s live."}),s.jsx(x,{className:"btn",to:"/dashboard/connections",children:"My Connections"})]})]}):s.jsxs(s.Fragment,{children:[s.jsx(g,{}),s.jsxs("div",{className:"container",children:[s.jsx("div",{className:"banner",children:"Today’s picks curated just for you."}),d.length===0?s.jsx("div",{className:"empty",children:"No profiles assigned to you yet. Please check back later."}):h.length===0?s.jsx("div",{className:"empty",children:"Loading assigned profiles…"}):s.jsx(U,{children:h.map(e=>s.jsx(E,{photoUrl:e.photoUrl,name:"Hidden until matched",instagramId:void 0,bio:e.bio,interests:e.interests,footer:s.jsx("button",{className:`btn ${o.has(e.uid)?"ghost":"primary"}`,onClick:()=>k(e.uid),disabled:o.has(e.uid),children:o.has(e.uid)?"Liked":"Like"})},e.uid))}),s.jsx("div",{style:{marginTop:24},children:s.jsx(x,{className:"btn ghost",to:"/dashboard/connections",children:"My Connections"})})]})]})}export{D as default};
